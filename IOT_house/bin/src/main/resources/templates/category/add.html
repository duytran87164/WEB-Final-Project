<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Thêm hoặc Chỉnh sửa Danh mục</title>
</head>
<body>
	<div th:insert="~{fragments/header}"></div>

	<form th:action="@{/admin/categories/save}" method="post"
		enctype="multipart/form-data">
		<input type="hidden" name="isEdit"
			th:value="${cate?.isEdit != null ? cate.isEdit : false}">

		<!-- Nhập tên danh mục -->
		<label for="clientname">Client Name:</label> <input type="hidden"
			th:value="${cate?.id}" name="id"> <input type="text"
			id="clientname" name="client_name" th:value="${cate?.client_name}" /><br>
		<br> <label for="id_house">ID House:</label> <input type="text"
			id="idhouse" name="id_house" th:value="${cate?.id_house}" /><br>
		<br> <label for="psw">Password:</label> <input type="password"
			id="password" name="password" th:value="${cate?.password}" /><br>
		<br>
		<!-- Hiển thị hình ảnh nếu có -->
		<label for="image">Images:</label><br>
		<div th:if="${cate == null or !cate.isEdit}">
			<img id="image" src="#" alt="Image Preview" style="display: none; max-width: 200px; max-height: 150px;" /><br>
		</div>
<!-- 			 <div th:if="${cate == null }">
			  <img id="image" src="#" alt="Image Preview" style="display: none; max-width: 200px; max-height: 150px;" /><br></div> -->
		<div th:if="${cate != null && cate.image != null}">
			<img th:if="${#strings.startsWith(cate.image, 'https')}"
				th:src="${cate.image}" height="150" width="200" id="image" /> <img
				th:if="${!#strings.startsWith(cate.image, 'https')}"
				th:src="@{/file/image(fname=${cate.image})}" height="150"
				width="200" id="image" />
		</div>

		<!-- Chọn file hình ảnh -->
		<input type="file" onchange="chooseFile(this)" id="imageFile"
			name="imageFile" /><br>

		<!-- Nhập URL hình ảnh từ internet -->
		<input type="text" id="imageUrl" name="image"
			placeholder="Nhập URL hình ảnh" th:value="${cate?.image ?: ''}" /><br>
		<br>

		<script>
			function chooseFile(input) {
				if (input.files && input.files[0]) {
					const reader = new FileReader();
					reader.onload = function(e) {
						const previewImage = document
								.getElementById("image");
						previewImage.src = e.target.result;
						previewImage.style.display = "block"; // Hiện ảnh sau khi tải
					};
					reader.readAsDataURL(input.files[0]);
				}
			}
		</script>


		<!-- Chọn trạng thái bằng radio button -->
		<label for="status">Status:</label><br> <input type="radio"
			id="active" name="status" value="1" th:checked="${cate?.status == 1}" />
		<label for="active">Đang hoạt động</label><br> <input
			type="radio" id="inactive" name="status" value="0"
			th:checked="${cate?.status == 0}" /> <label for="inactive">Khóa</label><br>
		<br>

		<!-- Hiển thị nút Insert hoặc Update -->
		<div th:if="${cate == null or !cate.isEdit}">
			<input type="submit" value="Insert" />
		</div>
		<div th:if="${cate != null and cate.isEdit}">
			<input type="submit" value="Update" />
		</div>
	</form>

	<div th:insert="~{fragments/footer}"></div>
</body>
</html>
